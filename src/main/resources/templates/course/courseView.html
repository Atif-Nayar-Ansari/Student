<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      xmlns="http://www.w3.org/1999/html"
      layout:decorator="layout/layout" lang="en">

<head>
    <style>
        .required:after {
            content: " *";
            color: red;
        }
    </style>

    <title>View Courses</title>

    <script th:inline="javascript">
        /*<![CDATA[*/

        var BASE_URL = window.location.origin + "/" + window.location.pathname.split("/")[0];

        $(document).ready(function () {

            $('#courseTable').parent().find('[data-tooltip="tooltip"]').tooltip({trigger :'hover'});

            $('#courseTable').DataTable({
                "order": [1, "asc"],
                "columns": [
                    null,
                    null,
                    null,
                    null,
                    null,
                    {
                        "searchable": false,
                        "orderable": false
                    }
                ]
            });

            $('#courseTable').on('click','#editButton',function (){
                var courseId = $(this).val();

                //have to pass this above pk  to the below ajax call
                var url = BASE_URL + 'course/getOneCourse/' + courseId;

                $.ajax({
                    type: 'get',
                    url: url,
                    success: function (data){
                        $('#modalResult').html(data);
                        $('#editModal').modal('show');
                    }
                })
            })

        });

        /*]]>*/
    </script>

</head>

<body>
<div class="page-header" layout:fragment="header">
        <h1>View Courses.</h1>
        <img style="width: 30px;" th:src="@{/images/info.gif}">
</div>
<div layout:fragment="content" class="jumbotron">
    <div th:if="${allCourses != null}">
        <div th:if="${#lists.size(allCourses) == 0}">
            <div class="alert alert-info text-center">No Courses Available</div>
        </div>
        <div th:if="${#lists.size(allCourses) != 0}">
            <table class="table table-bordered table-hover table-striped" id="courseTable"
                   aria-label="all-courses-table">
                <thead>
                <tr style="background-color: #7F9D3F">
                    <th scope="col"><strong>Pks</strong></th>
                    <th scope="col"><strong>Course Name</strong></th>
                    <th scope="col"><strong>Course Fees</strong></th>
                    <th scope="col"><strong>Course Duration</strong></th>
                    <th scope="col"><strong>Created Date</strong></th>
                    <th scope="col"><strong>Actions</strong></th>
                </tr>
                </thead>
                <tbody>
                <tr th:each="course : ${allCourses}">
                    <td th:text="${course.coursePk}"></td>
                    <td th:text="${course.courseName}"></td>
                    <td th:text="${course.coursePrice}"></td>
                    <td th:text="${course.courseDuration}"></td>
                    <td th:text="${course.createdTs}"></td>
                    <td>
                        <button data-toggle="modal" data-tooltip="tooltip" data-placement="top" title="Edit" id="editButton" th:value="${course.coursePk}">
                            <img style="width: 30px;" th:src="@{/images/settings.gif}">
                        </button>
                        <button data-tooltip="tooltip" data-placement="top" title="Delete" id="deleteButton">
                            <img style="width: 30px;" th:src="@{/images/waste.gif}">
                        </button>
                    </td>
                </tr>
                </tbody>
            </table>
        </div>
    </div>

    <div id="modalResult"></div>


    <!--if it returns null-->
    <div th:if="${allCourses == null}">
        <div class="alert alert-danger text-center">Something Bad Happend..</div>
    </div>
</div>
</body>
</html>